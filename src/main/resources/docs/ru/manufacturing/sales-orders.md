---
title: Создание производственных заказов из заказов покупателя
---

В системе предусмотрен сценарий, когда **[производственные заказы](orders.md) создаются на основании строк заказа покупателя**.

Это удобно, когда вы продаёте изделия, которые нужно изготовить под конкретный заказ.

## Условия, при которых возможно создание

[Производственные заказы](orders.md) создаются из заказа покупателя при одновременном выполнении условий:

1. У **типа заказа покупателя** указан **[тип производственного заказа](settings.md)**.
2. Заказ покупателя имеет статус **подтверждён**.
3. В заказе есть строки, где:
   - указана **[спецификация](bom.md)**;
   - по строке ещё не создан [производственный заказ](orders.md).

Если хотя бы одно из условий не выполнено, кнопка создания может не отображаться, либо действие ничего не создаст.

## Как выбрать [спецификацию](bom.md) в строке заказа покупателя

В строке заказа покупателя есть поле [спецификации](bom.md).

Правила:

- спецификация должна соответствовать номенклатуре строки (в противном случае система не позволит сохранить строку);
- если для номенклатуры существует [спецификация](bom.md) по умолчанию, она может подставляться автоматически.

## Создание вручную

В карточке заказа покупателя доступно действие **«Производственные заказы»**.

Как работает:

1. Пользователь нажимает действие создания.
2. Система проходит по строкам заказа.
3. Для каждой строки, где указана [спецификация](bom.md) и ещё нет [производственного заказа](orders.md), создаётся новый производственный заказ.

## Что заполняется в создаваемом производственном заказе

[Производственный заказ](orders.md) создаётся **по каждой строке** заказа покупателя.

При создании автоматически заполняются:

- связь с исходной строкой заказа покупателя;
- статус ожидания (заказ создаётся как ожидающий);
- **[тип производственного заказа](settings.md)** — берётся из типа заказа покупателя;
- **дата запуска** — берётся из заказа покупателя;
- **место хранения готовой продукции** — берётся из места хранения заказа покупателя;
- **номенклатура** — берётся из строки заказа покупателя;
- **[спецификация](bom.md)** — берётся из строки заказа покупателя;
- строки материалов и выпуска формируются по количеству строки заказа покупателя.

Дополнительно может выполняться расширяемое заполнение (в зависимости от вашей конфигурации).

## Автоматическое создание при подтверждении

В типе заказа покупателя может быть включён параметр **автоматического создания производственных заказов**.

Если он включён, то при подтверждении заказа покупателя:

- система автоматически создаёт [производственные заказы](orders.md) по строкам.

## Синхронизация изменений

Если включено автоматическое создание, то изменения в строках заказа покупателя синхронизируются с [производственным заказом](orders.md), пока он не запущен:

- при изменении количества строки — пересчитываются строки материалов и выпуска производственного заказа;
- при изменении номенклатуры — номенклатура производственного заказа обновляется и пересчитываются строки;
- при изменении спецификации — спецификация производственного заказа обновляется и пересчитываются строки.

Ограничения:

- если производственный заказ уже запущен, менять количество/номенклатуру/спецификацию в исходной строке запрещено.

## Отмена заказа покупателя

Если заказ покупателя отменяется и включено автоматическое создание:

- связанные производственные заказы автоматически переводятся в отменённые.

Также есть ограничение:

- нельзя отменить заказ покупателя, если по нему есть запущенные производственные заказы.

## Где посмотреть связанные производственные заказы

В карточке заказа покупателя отображается блок связанных производственных заказов:

- видны номер, дата запуска, статус, тип;
- можно открыть производственный заказ.

В самом производственном заказе отображается ссылка на исходный заказ покупателя.

## Типовые ошибки

- **Кнопка создания не отображается** — заказ не подтверждён или у типа заказа не задан тип производственного заказа.
- **Ничего не создаётся** — в строках не указаны спецификации или по строкам уже есть производственные заказы.
- **Нельзя удалить строку** — по этой строке уже создан производственный заказ.
- **Нельзя изменить количество/номенклатуру/спецификацию** — по строке уже есть запущенный производственный заказ.