---
title: Отгрузки по заказам
---

[Отгрузка](../inventory/shipments.md) фиксирует передачу товара покупателю и движение по месту хранения.

## Где находится

Обычно доступно в разделе **«Продажи» → «Операции»** (либо в разделе «Склад» — зависит от конфигурации).

## Связь с заказом

Отгрузка может создаваться на основании заказа покупателя. В этом случае:

- подставляются [контрагент](../masterdata/partners.md) и адрес доставки;
- подставляется [место хранения](../inventory/locations.md);
- строки отгрузки формируются по строкам заказа.

## Связь отгрузок и заказов покупателя: как работает в системе

Ниже описана логика связи «заказ покупателя ↔ отгрузки».

### Связь на уровне строк

Связь отгрузки с заказом хранится не только «шапкой», но и **через строки**:

- каждая строка отгрузки связана с конкретной строкой заказа;
- по этой связи система считает:
  - сколько зарезервировано под строку заказа;
  - сколько уже отгружено;
  - сколько осталось отгрузить.

Практический смысл: можно отгружать один заказ несколькими отгрузками и частями.

### Остаток к отгрузке

Для строки заказа система считает:

- **Отгружено** — сумма по активным отгрузкам;
- **Осталось отгрузить** = количество строки (с учётом коэффициента упаковки/единицы) − отгружено.

Если по строке отгружено больше, чем в заказе, система выдаст ошибку.

### «Резервная» отгрузка заказа (ожидающая)

В системе предусмотрен механизм автоматической «резервной» отгрузки, которая поддерживается в актуальном состоянии по заказу.

Условия, при которых она создаётся/обновляется:

- заказ находится в статусе подтверждения;
- у типа заказа задан тип отгрузки;
- в заказе выбрано место хранения;
- по заказу есть что отгружать (остаток к отгрузке больше нуля).

Как это выглядит для пользователя:

1. Вы подтверждаете заказ.
2. Система создаёт (или находит) ожидающую отгрузку по этому заказу.
3. В ожидающей отгрузке автоматически поддерживаются:
   - [контрагент](../masterdata/partners.md);
   - подразделение (если используется);
   - плановая дата;
   - адрес доставки;
   - [место хранения](../inventory/locations.md).

### Как формируются строки в ожидающей отгрузке

При создании/обновлении ожидающей отгрузки система:

- добавляет строки отгрузки для тех строк заказа, по которым есть остаток к отгрузке;
- в строку отгрузки подставляет товар (с учётом преобразования номенклатуры, если оно используется);
- фиксирует «первоначальную потребность» по строке отгрузки, равную текущему остатку к отгрузке.

Если по строке заказа остаток стал равен нулю (всё отгрузили), соответствующая строка отгрузки удаляется.
Если в ожидающей отгрузке не осталось строк, такая отгрузка удаляется.

После формирования строк система выполняет предварительную проверку наличия по ожидающей отгрузке.

### Несколько отгрузок по одному заказу

Один заказ может быть связан с несколькими отгрузками. Это бывает, например, при частичных отгрузках или при разделении по местам хранения.

В карточке заказа отображается список связанных отгрузок.
Также в карточке отгрузки отображается список связанных заказов.

### Ограничения при блокировке заказа

В типе заказа могут быть включены дополнительные ограничения:

- запрет блокировки заказа, если по нему есть активные отгрузки;
- запрет блокировки заказа, если он отгружен не полностью.

Если ограничения включены, система не позволит выполнить блокировку.

## Создание отгрузки на основании реализации

Сценарий «отгрузка из реализации» описан на отдельной странице: [Создание отгрузки на основании реализации](../invoicing/shipments-from-invoice.md).

## Типовой сценарий

1. Откройте заказ покупателя.
2. Создайте отгрузку по заказу.
3. Проверьте количество по строкам.
4. Проведите/подтвердите отгрузку согласно правилам вашей организации.