---
title: Регистрация времени
---

Функция **Регистрация времени** используется для фиксации отметок рабочего времени сотрудника:

- **Вход (Check In)** — начало рабочего времени
- **Выход (Check Out)** — окончание рабочего времени

Каждая отметка создаёт/обновляет запись **Регистрации времени**. В зависимости от способа регистрации система также может сохранять **геолокацию** (широта/долгота) и **фотографии**.

## Что фиксируется

Для каждой записи регистрация времени хранит:

- **Сотрудник** — автоматически устанавливается на текущего пользователя при создании записи.
- **Дата и время входа (Check In)** — обязательно.
- **Дата и время выхода (Check Out)** — необязательно до момента выхода.
- **Отработанные часы** — рассчитываются как разница между входом и выходом.
- **Геолокация входа/выхода** — значения широты и долготы (если доступны).
- **Фото входа/выхода** — сохраняются при использовании киоска (если устройство/камера настроены).

## Основные правила (как система решает, что делать)

- Система учитывает **последнюю запись регистрации времени** сотрудника.
- Если в последней записи **ещё нет времени выхода**, она считается **открытой**.
  - В этом случае следующая отметка будет **Выход (Check Out)**.
- Если **открытой** записи нет, следующая отметка будет **Вход (Check In)**.

## Способы регистрации

### Мобильная регистрация времени

Сотрудник фиксирует отметки через мобильный интерфейс (дашборд **Регистрация времени**).

Форма показывает:

- крупные кнопки **Start** (вход) / **Stop** (выход);
- текущий статус (открыто/закрыто) по последней записи;
- список последних записей для текущего пользователя (сортировка по самому позднему входу);
- итоги за **эту неделю** и **этот месяц**.

### Требование геолокации (mobile)

На мобильном устройстве кнопки входа/выхода могут быть недоступны, если геолокация не получена.

- Если **широта/долгота не получены**, кнопки **Start**/**Stop** отключены.
- Исключение: если сотруднику разрешено отмечаться **без геолокации** (см. «Настройки и права доступа»).

Блок геолокации также показывает:

- текущие значения **широты** и **долготы**;
- сообщение об **ошибке** (если клиент не может получить позицию);
- элемент управления для запроса текущей позиции устройства.

Примечание:

- мобильная форма периодически обновляется автоматически, поэтому отображаемое «отработано с момента входа» остаётся актуальным.

### Что происходит при входе (mobile)

Когда сотрудник нажимает **Start**:

1. Создаётся новая запись регистрации времени.
2. Устанавливается дата и время **входа**.
3. Если доступны, сохраняются **широта/долгота** для входа.
4. Форма переходит к созданной записи в списке.

### Что происходит при выходе (mobile)

Когда сотрудник нажимает **Stop**:

1. Система находит **последнюю** запись регистрации времени сотрудника.
2. Устанавливается дата и время **выхода**.
3. Если доступны, сохраняются **широта/долгота** для выхода.

Действие **Stop** запрашивает подтверждение.

Рекомендации:

- перед регистрацией убедитесь, что на устройстве включено определение местоположения;
- при плохом сигнале геолокации отметка может быть недоступна или может требовать повторной попытки.

### Киоск регистрации времени

Киоск используется, когда сотрудникам удобнее отмечаться на рабочем месте (например, у входа в офис или на проходной).

Типовой сценарий:

1. Сотрудник сканирует **бейдж / штрихкод**.
2. Система декодирует значение и пытается сопоставить его сотруднику.
3. В зависимости от текущего состояния фиксируется **Вход (Check In)** или **Выход (Check Out)**.
4. Сохраняется **фотография** (если устройство киоска поддерживает съемку).

Киоск использует диалог подтверждения с данными сотрудника и крупным сообщением:

- **Check In** (зелёный)
- **Check Out** (красный)

Если сотрудник не распознан, на экране отображается сообщение **«Сотрудник не найден»**.

### Особенности киоска

- Киоск предотвращает повторную обработку одного и того же значения в течение короткого времени (чтобы избежать двойного сканирования).
- Киоск может показывать список сотрудников, которые **отметились рядом** (на основе сравнения текущих координат киоска с сохранёнными координатами входа).

## Настройки и права доступа

### Регистрация времени без геолокации

Есть настройка на уровне сотрудника **Регистрация времени без геолокации**.

- Если включена для сотрудника, он может отмечаться с мобильного устройства даже когда система не может получить широту/долготу.
- Если выключена, кнопки **Start/Stop** требуют валидную геолокацию.

Опция находится на карточке сотрудника в секции **Регистрация времени**.

## Просмотр и редактирование (back office)

Формы для работы с записями регистрации:

- **Регистрация времени** — просмотр одной записи (включая геолокацию и фото, если есть).
- **Регистрации времени** — список записей с фильтрами:
  - **Открытые** (выход ещё не выполнен)
  - **Закрытые** (выход выполнен)

В зависимости от прав, пользователи могут вручную создавать/редактировать/удалять записи в back office (например, для корректировок).

## Частые ситуации

### Не удаётся зарегистрировать отметку из-за геолокации

Возможные причины:

- на устройстве отключена геолокация;
- отсутствует доступ приложения к геолокации;
- сотруднику не разрешено отмечаться без геолокации.

Что сделать:

- включить службы определения местоположения на устройстве;
- выдать приложению разрешение на геолокацию;
- если в организации допускается, попросить администратора включить **Регистрация времени без геолокации** для сотрудника.

### Отработанные часы не отображаются / выглядят неверно

Отработанные часы рассчитываются по времени **входа** и **выхода**.

Проверьте:

- что сотрудник выполнил выход (иначе запись считается «открытой»);
- что время на устройстве выставлено корректно;
- если были ручные корректировки, проверьте даты/время входа и выхода.

### Сотрудник не находится в списке на киоске

Проверьте:

- корректность бейджа (штрихкод/номер);
- что сотрудник оформлен в системе;
- права доступа к регистрации времени.

Если киоск показывает список отметившихся рядом, проверьте также:

- что геолокация киоска доступна;
- что вход сотрудника был зафиксирован вместе с геолокацией.